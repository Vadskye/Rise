\ExplSyntaxOn


\newmdenv[
  backgroundcolor=lavenderweblight,
  leftline=true,
  topline=true,
  rightline=true,
  bottomline=true,
  roundcorner=4pt,
  skipabove=0.5em,
  skipbelow=0.5em,
  leftmargin=0pt,
  innerleftmargin=0.25em,
  innerrightmargin=0.5em,
  innertopmargin=0.5em,
  innerbottommargin=0.25em,
]{eliteabilitymdframed}
% #1 = if true, include \label{#3}
% #2 = Suffix after the name not used for label/targets/etc. Not bold.
% #3 = Name of the ability
% #4 = Usage time
\DeclareDocumentEnvironment{eliteability}{s o m m}
{
  \begin{eliteabilitymdframed}
    \RaggedRight
    \lowercase{\hypertargetraised{ability:#3}{}}
    \hypertargetraised{ability:#3}{}
    \IfBooleanT{#1}{\nonsectionlabel{#3}}
    \spelltwocol{
      {\normalsize \textbf{#3}}
      \IfValueT{#2}{#2}
    }{
      #4
    }
    }
    {
  \end{eliteabilitymdframed}
}

\DeclareDocumentEnvironment{magicaleliteability}{s m m}
{
\IfValueTF{#1}{
  \begin{eliteability}*[\sparkle]{#2}{#3}
}{
  \begin{eliteability}[\sparkle]{#2}{#3}
    }
    }
    {
  \end{eliteability}
}

\newmdenv[
  backgroundcolor=verylightred,
  leftline=true,
  topline=true,
  rightline=true,
  bottomline=true,
  roundcorner=4pt,
  skipabove=0.5em,
  skipbelow=0.5em,
  leftmargin=0pt,
  innerleftmargin=0.25em,
  innerrightmargin=0.5em,
  innertopmargin=0.5em,
  innerbottommargin=0.25em,
]{triggeredabilitymdframed}
% #1 = if true, include \label{#3}
% #2 = Suffix after the name not used for label/targets/etc. Not bold.
% #3 = Name of the ability
% #4 = Usage time
\DeclareDocumentEnvironment{triggeredability}{s o m m}
{
  \begin{triggeredabilitymdframed}
    \RaggedRight
    \lowercase{\hypertargetraised{ability:#3}{}}
    \hypertargetraised{ability:#3}{}
    \IfBooleanT{#1}{\nonsectionlabel{#3}}
    \spelltwocol{
      {\normalsize \textbf{#3}}
      \IfValueT{#2}{#2}
    }{
      #4
    }
    }
    {
  \end{triggeredabilitymdframed}
}

\DeclareDocumentEnvironment{magicaltriggeredability}{s m m}
{
\IfValueTF{#1}{
  \begin{triggeredability}*[\sparkle]{#2}{#3}
}{
  \begin{triggeredability}[\sparkle]{#2}{#3}
    }
    }
    {
  \end{triggeredability}
}

\newmdenv[
  backgroundcolor=MintCream,
  leftline=true,
  topline=true,
  rightline=true,
  bottomline=true,
  roundcorner=4pt,
  skipabove=0.5em,
  skipbelow=0.5em,
  leftmargin=0pt,
  innerleftmargin=0.25em,
  innerrightmargin=0.5em,
  innertopmargin=0.5em,
  innerbottommargin=0.25em,
]{activeabilitymdframed}
% #1 = if true, include \label{#3}
% #2 = Suffix after the name not used for label/targets/etc. Not bold.
% #3 = Name of the ability
% #4 = Usage time
\DeclareDocumentEnvironment{activeability}{s o m m}
{
  \begin{activeabilitymdframed}
    \RaggedRight
    \lowercase{\hypertargetraised{ability:#3}{}}
    \hypertargetraised{ability:#3}{}
    \IfBooleanT{#1}{\nonsectionlabel{#3}}
    \spelltwocol{
      {\normalsize \textbf{#3}}
      \IfValueT{#2}{#2}
    }{
      #4
    }
    }
    {
  \end{activeabilitymdframed}
}

\newmdenv[
  backgroundcolor=cosmiclatte,
  leftline=true,
  topline=true,
  rightline=true,
  bottomline=true,
  roundcorner=4pt,
  skipabove=0.5em,
  skipbelow=0.5em,
  leftmargin=0pt,
  innerleftmargin=0.25em,
  innerrightmargin=0.5em,
  innertopmargin=0.5em,
  innerbottommargin=0.25em,
]{sustainabilitymdframed}
\DeclareDocumentEnvironment{sustainability}{s o m m}
{
  \begin{sustainabilitymdframed}
    \RaggedRight
    \lowercase{\hypertargetraised{ability:#3}{}}
    \hypertargetraised{ability:#3}{}
    \IfBooleanT{#1}{\nonsectionlabel{#3}}
    \spelltwocol{
      {\normalsize \textbf{#3}}
      \IfValueT{#2}{#2}
    }{
      #4
    }
    }
    {
  \end{sustainabilitymdframed}
}

\newmdenv[
  backgroundcolor=brown!8,
  leftline=true,
  topline=true,
  rightline=true,
  bottomline=true,
  roundcorner=4pt,
  skipabove=0.5em,
  skipbelow=0.5em,
  leftmargin=0pt,
  innerleftmargin=0.25em,
  innerrightmargin=0.5em,
  innertopmargin=0.5em,
  innerbottommargin=0.25em,
]{attuneabilitymdframed}
\DeclareDocumentEnvironment{attuneability}{s o m m}
{
  \begin{attuneabilitymdframed}
    \RaggedRight
    \lowercase{\hypertargetraised{ability:#3}{}}
    \hypertargetraised{ability:#3}{}
    \IfBooleanT{#1}{\nonsectionlabel{#3}}
    \spelltwocol{
      {\normalsize \textbf{#3}}
      \IfValueT{#2}{#2}
    }{
      #4
    }
    }
    {
  \end{attuneabilitymdframed}
}

\DeclareDocumentEnvironment{magicalactiveability}{s m m}
{
\IfValueTF{#1}{
  \begin{activeability}*[\sparkle]{#2}{#3}
}{
  \begin{activeability}[\sparkle]{#2}{#3}
    }
    }
    {
  \end{activeability}
}

\DeclareDocumentEnvironment{magicalsustainability}{s m m}
{
\IfValueTF{#1}{
  \begin{sustainability}*[\sparkle]{#2}{#3}
}{
  \begin{sustainability}[\sparkle]{#2}{#3}
    }
    }
    {
  \end{sustainability}
}


\DeclareDocumentEnvironment{magicalattuneability}{s m m}
{
\IfValueTF{#1}{
  \begin{attuneability}*[\sparkle]{#2}{#3}
}{
  \begin{attuneability}[\sparkle]{#2}{#3}
    }
    }
    {
  \end{attuneability}
}

\ExplSyntaxOff
