\chapter{Spells and Rituals}\label{Spells and Rituals}

\section{Spell and Ritual Mechanics}\label{Spell and Ritual Mechanics}

    Spells and rituals share many common properties, defined here.

    \subsection{Categories of Magic}
        There are four \glossterm{magic sources} that spells can come from: arcane (cast by mages), divine (cast by clerics and paladins), nature (cast by druids), and pact (cast by warlocks).
        In addition, there are nine schools of magic.
        Each school of magic has a set of thematically related effects.
        Every spell and ritual belongs to at least one school of magic.
        The schools of magic are described below.

        \subsubsection{Abjuration}
            Abjuration spells and rituals reduce or negate damage, magic, and other effects.
            They can be used to protect allies and remove harmful magic.

        \subsubsection{Channeling}
            Channeling spells and rituals call upon the power of deities or other supernatural entities.
            They can be used to do anything those entities could do.
            Arcane spellcasters do not have access to Channeling spells.

        \subsubsection{Conjuration}
            Conjuration spells and rituals create and transport objects and creatures.
            They can be used to summon allies, transport creatures, and create objects from thin air.

        \subsubsection{Divination}
            Divination spells and rituals grant knowledge.
            They can be used to reveal hidden truths, predict the future, or communicate at great distances.

        \subsubsection{Enchantment}
            Enchantment spells and rituals alter the minds of creatures.
            They can be used to influence, control, or debilitate creatures.
            Almost all enchantment spells and rituals have the \glossterm{Mind} tag, and many have the \glossterm{Subtle} as well (see \pcref{Ability Tags}).

        \subsubsection{Evocation}
            Evocation spells and rituals create and manipulate energy.
            They can be used to inflict damage with energy blasts or manipulate the environment.

        \subsubsection{Illusion}
            Illusion spells and rituals create or manipulate sensory impressions.
            They can be used to create or remove light, conceal things that exist, or cause creatures to perceive things that do not exist.

        \subsubsection{Transmutation}
            Transmutation spells and rituals change the properties of creatures and objects.
            They can be used to grant new abilities, enhance existing abilities, change a target's form, or even alter the flow of time itself.

        \subsubsection{Vivimancy}
            Vivimancy spells and rituals manipulate the power of life and death, as well as souls.
            They can be used to heal or inflict wounds, resurrect the dead, create undead monsters, and cripple the bodies of creatures.

    \subsection{Casting Components}\label{Casting Components}
        Unless otherwise noted, all spells and rituals require both verbal and somatic components to cast or perform.
        You cannot start casting a spell or performing a ritual without all required components.
        If you lose those components before the ability resolves, it is \glossterm{miscast}.

        To provide the verbal component for a spell or ritual, you must speak in a strong voice with a volume at least as loud as ordinary conversation.
        To provide the somatic component for a spell or ritual, you must make a measured and precise movement of at least one free hand.

    \subsection{Concentration}\label{Concentration}
        Some abilities, such as spells and rituals, require focused thought to use successfully.
        If your focus is tested, such as by casting a spell defensively (see \pcref{Defensive Casting}), you may need to make a \glossterm{concentration} check.
        Your bonus with a concentration check is equal to your level or your Willpower, whichever is higher.
        You apply any \glossterm{overwhelm penalties} you suffer as penalties to concentration checks.

        Success on a concentration check generally means you successfully use the ability that triggered the check.
        Failure generally means that you do not use the ability successfully.

    \subsection{Miscasting}\label{Miscasting}

        If you start using a spell or ritual and fail to complete it successfully for any reason, you miscast it.
        A miscast spell or ritual does not have its normal effect.
        Instead, a wave of magical energy causes a \glossterm{miscast backlash}.
        When a mystic backlash occurs, make an attack against the Mental defense of yourself and all creatures in a 5 foot radius from you.
        Your \glossterm{power} with this ability is equal to your \glossterm{power} with the spell or ritual you tried to use.
        % damage type?
        On a hit, each target takes \glossterm{standard damage} \minus1d.

        \parhead{Impossible Spells and Rituals} When you try to use a spell or ritual in an impossible way, the ability is \glossterm{miscast} instead.
        This most commonly happens if you attempt to declare an invalid target for a spell.
        For example, if you try to cast a spell that only affects living creatures on a creature that is undead, the spell would be miscast.

        % TODO: This may be more clear if minor + no miscast becomes a tag.
        % Also, would it be better to prohibit miscasts on spells that don't cost action points?
        \parhead{Minor Action Spells} Spells that require a \glossterm{minor action} to cast are not miscast if your concentration is broken while casting the spell.
        Instead, the spell simply fizzles without any effect.

    \subsection{Focused and Defensive Casting}\label{Focused and Defensive Casting}
        The concentration required to use spells and rituals can impair your ability to defend yourself.
        When you use a spell or ritual, you choose whether to use \glossterm{focused casting} or \glossterm{defensive casting}.
        For rituals, you can change your choice during each phase that you spend performing the ritual.
        % This is a hack to prevent playing games involving delaying casting until the delayed action phase
        % to avoid being disruptible without taking defense penalties.
        You cannot use \glossterm{focused casting} if you are distracted, as your concentration is divided.
        You are distracted if you are experiencing violent motion, such as if you are on a galloping horse, or if you already took damage during the current round.

        \subsubsection{Focused Casting}\label{Focused Casting}
            If you use a spell or ritual with \glossterm{focused casting}, you suffer a \minus4 penalty to all defenses during each \glossterm{phase} where you concentrate on the ability.

        \subsubsection{Defensive Casting}\label{Defensive Casting}
            If you use a spell or ritual using \glossterm{defensive casting}, you suffer no penalty to defenses.
            In exchange, you have to make a \glossterm{concentration} check to use the ability successfully (see \pcref{Concentration}).
            The \glossterm{difficulty rating} of the check is equal to 4 if the spell is a cantrip.
            Otherwise, it is equal to 5 \add three times the level of the spell you are casting, as shown on \tref{Concentration DRs}.
            Success means that you use the ability successfully.
            Failure means that you \glossterm{miscast} the spell or ritual (see Miscasting, below).

            When you use defensive casting to perform a ritual, you must make a new check during each phase.

            \begin{dtable}
                \lcaption{Concentration DRs}
                \begin{dtabularx}{\columnwidth}{l X}
                    \tb{Spell Level} & \tb{DR} \\
                    \bottomrule
                    Cantrip & 4 \\
                    1st level & 8 \\
                    2nd level & 11 \\
                    3rd level & 15 \\
                    4th level & 18 \\
                    5th level & 21 \\
                    6th level & 24 \\
                    7th level & 27 \\
                \end{dtabularx}
            \end{dtable}


    \subsection{Augments}\label{Augments}
        There are a number of \glossterm{augments} that can be applied to spells and rituals to increase their power.
        Each augment has a name, a level, and an effect.
        When you cast a spell or perform a ritual, can choose to apply any number of augments you know to the spell or ritual.
        For each augment you apply, you increase the spell or ritual's level by an amount equal to the augment's level.
        In exchange, the ability gains the effects of that augment.
        If an augment would increase the spell or ritual's level beyond the maximum level you can cast, you cannot apply the augment to that ability.

        \parhead{Augments and Cantrips}
        You can apply augments to \glossterm{cantrips}.
        Cantrips are considered to be 1st level spells for this purpose.

        \subsubsection{Augment Descriptions}\label{Augment Descriptions}

            \augment{1}{Cryptic} The spell's visual effects and magical aura changes to mimic a different spell of your choice.
            You may choose any combination of spell or \glossterm{subspell} you know, along with any other augments, that result in a spell of the same level or lower as the spell you are casting.
            This affects inspection of the spell itself by any means, such as with the Spellcraft skill (see \pcref{Spellcraft}).
            However, it does not alter the mechanical effects of the spell in any way.
            If the spell's effects depend on visual components, the spell may fail to work if you alter the spell's visuals too much. 

            \augment{1}{Selective} You may freely exclude any areas from the spell's effect.
            However, all squares in the final area of the spell must be contiguous.
            You cannot create split a spell's area into multiple completely separate areas.
            \par This augment can be applied to any spell or ritual that affects an area.

            \augment{1}{Silent} You do not need to use \glossterm{verbal components} to cast the spell.
            \par This augment can be applied to any spell.

            \augment{1}{Stilled} You do not need to use \glossterm{somatic components} to cast the spell.
            \par This augment can be applied to any spell.

            \augment{2}{Accelerated} The ritual takes half the normal amount of time to perform.
            \par This augment can be applied to any ritual.

            \augment{2}{Empowered} The ability's \glossterm{power} increases by 2.
            This augment can be applied multiple times.
            Its effects stack.
            \par This augment can be applied to any spell or ritual.

            % TODO: Too weak at 2?
            \augment{2}{Extended} The ability's range increases by one step, to a maximum of \rngext.
            The steps are, in order: \rngclose, \rngmed, \rnglong, and \rngext.
            This augment can be applied multiple times.
            Each time, the ability's range increases by an additional step.
            \par This augment can be applied to any spell or ritual with a range that is one of the above ranges.

            % Too weak at 2, weird narrative at 1?
            \augment{2}{Giant} The ability can affect a target one size category larger.
            This augment can be applied multiple times.
            Its effects stack.
            \par This augment can be applied to any spell or ritual that that has a maximum size category of targets that it can affect.

            \augment{2}{Precise} You gain a \plus1 bonus to accuracy with the ability.
            This augment can be applied multiple times.
            Its effects stack.
            \par This augment can be applied to any spell or ritual that has an attack roll.

            \augment{2}{Quickened} You can cast the spell as a \glossterm{minor action}.
            In exchange, you cannot take any actions during the \glossterm{action phase} or \glossterm{delayed action phase} of the next round.
            \par This augment can be applied to any spell.

            % too weak at 2?
            \augment{2}{Widened} The ability's area increases by one step, to a maximum of \areahuge.
            The steps are, in order: \areasmall, \areamed, \arealarge, and \areahuge.
            Normally, a Small or Medium line is 5 ft.\ wide, while a Large or Huge line is 10 ft.\ wide.
            A line used to define a wall does not have a width.
            This augment can be applied multiple times.
            Each time, the ability's area increases by an additional step.
            \par This augment can be applied to any spell or ritual with an area that is one of the above areas.

            % too weak at 3?
            \augment{3}{Phasing} When determining whether you have \glossterm{line of sight} and \glossterm{line of effect} to a particular location with the spell, you can ignore a single solid obstacle up to five feet thick.
            This can allow you to cast spells through solid walls, though it does not grant you the ability to see through the wall.
            \par This augment can be applied to any spell with a range.

            % \augment{4}{Dual} The spell targets an additional creature within range.
            % This augment can be applied multiple times.
            % Its effects stack.
            % \par This augment can be applied to any spell that has a range and affects a single target of the caster's choice.
            % It cannot be applied to spells that affect a single specific target, such as the caster.
            % In addition, it cannot be applied to \glossterm{Attune} spells.

            % too weak at 4?
            \augment{4}{Echoing} During the \glossterm{delayed action phase} of the next round, the spell's effect occurs again.
            All choices you made for the original casting of the spell are made identically for the repeat casting.
            It affects the same area, targets, and so on.

            If the spell is now invalid, such as if all of its targets are out of range, the additional casting has no effect.
            \par This augment can be applied to any spell that does not have the \glossterm{Attune} tag.

            % Are there any exploitable spells?
            \augment{4}{Innate} You can cast the spell without spending an \glossterm{action point}.
            \par This augment can be applied to any spell that requires a standard action to cast and which does not have the \glossterm{Attune} or \glossterm{Sustain} tags.

    \subsection{Dismissal}
        As a \glossterm{minor action}, you can dismiss any spells or rituals you used that have lasting effects.
        This requires the same casting components (verbal and somatic) as casting the spell or performing the ritual normally.
        Spells and rituals can also be dismissed in other ways, such as after their effects have finished.
        When a spell or ability is dismissed, all of its lingering effects immediately end.
        % Should a spell be dismissed for all targets simultaneously, or per target?

    \subsection{Spell Power}

        The \glossterm{power} of your spells and rituals is normally equal to your \glossterm{magical power}.
        You can voluntarily reduce the \glossterm{power} of the spells you cast.
        The minimum power you can use to cast a spell is equal to twice the spell's level.

    \subsection{Resurrecting the Dead}\label{Resurrecting the Dead}
        Several rituals have the power to restore dead characters to life.

        When a living creature dies, its soul departs its body, travels through the Astral Plane, and goes to abide on the plane where the creature's deity resides.
        If the creature did not worship a deity, its soul departs to the plane corresponding to its alignment.
        Bringing a creature back from the dead means retrieving their soul and returning it to their body.

        \subparhead{Death and Old Age} While a creature is dead, it still tracks that time towards its maximum age.
        A creature's maximum age is largely determined by the strength of its soul, not the condition of its body.
        No magic can return a creature to life when it has passed its maximum age.

        \subparhead{Preventing Revivification} Enemies can take steps to make it more difficult for a character to be returned from the dead.
        Except for \spell{true resurrection}, every ritual to raise the dead requires a body, so keeping or destroying the body is an effective deterrent.
        The \spell{soul bind} ritual prevents any sort of revivification unless the soul is first released.

        \subparhead{Revivification against One's Will} A soul cannot be returned to life if it does not wish to be.
        A soul infallibly knows the name, alignment, and patron deity (if any) of the character attempting to revive it and may refuse to return on that basis.

% TODO: add generic text like ``Spells are magical effects that do stuff''
\section{Spells}\label{Spells}

    \subsection{Action Points}
        Subspells normally cost an \glossterm{action point} to cast.
        Subspells with the \glossterm{Attune} tag do not cost action points to cast, but require a creature to attune to the subspell's effect, which costs an action point.
        For details, see \pcref{Attunement}.

    \subsection{Cantrips}\label{Cantrips}
        Every spell can be cast as a \glossterm{cantrip}.
        You do not have to spend an action point to cast a spell as a cantrip.
        Cantrips are considered to be 1st level spells for the purpose of abilities that care about spell level, such as \glossterm{augments} (see \pcref{Augments}).
        You gain a \plus4 bonus to \glossterm{concentration} when casting a cantrip (see \pcref{Concentration}).

    \subsection{Subspells}\label{Subspells}
        % TODO: some of this wording is weird
        All spells have a number of \glossterm{subspells}.
        Each subspell has a name, a level, and an effect.
        When you cast a spell, you can choose to apply a single subspell you know from that spell.
        If you do, the spell's level becomes equal to the subspell's level.
        In exchange, the spell gains the effects of the subspell.
        You cannot learn or cast subspells whose spell level exceeds your maximum spell level.

        Some subspells simply add additional properties to a spell's normal effect.
        Others change the targets or effects of the spell significantly.
        After choosing whether to cast a subspell, you can apply any number of \glossterm{augments}, described below.

\section{Rituals}\label{Rituals}
    Rituals are ceremonies that create magical effects.
    Some spellcasting characters can learn and perform rituals.
    You don't memorize a ritual as you would a normal spell or subspell.
    Rituals are too complex for all but the most knowledgeable sages to commit to memory.
    To perform a ritual, you need to read from a book or a scroll containing it.
    Rituals are similar to spells, but abilities that affect spells do not affect rituals unless they say they do in their descriptions.

    \subsection{Ritual Descriptions}
        % TODO: proper chapter references
        Rituals are described in Chapter 13.
        The description of each ritual follows the same format as the description of spells in Chapter 12, except that every ritual has a level, like \glossterm{subspells} do.

        \subparhead{Ritual Sources}
        A ritual always matches the magic source of the person performing the ritual.
        For example, \spell{scrying} is an arcane ritual when performed by a wizard, but a divine ritual when performed by a cleric.

    \subsection{Ritual Requirements}
        In order to learn and perform a ritual, you must be able to cast at least one spell of the same level as the ritual.

    \subsection{Ritual Books}
        A ritual book contains one or more rituals that you can use as frequently as you want, as long as you can spend the time and \glossterm{action point} to perform the ritual.
        Scribing a ritual in a ritual book costs an amount of precious inks.

    \subsection{Ritual Costs}\label{Ritual Costs}
        The costs to scribe rituals are described on \trefnp{Ritual Costs}.
        \begin{dtable}
            \lcaption{Ritual Costs}
            \begin{dtabularx}{\columnwidth}{X l l}
                \tb{Ritual Level} & \tb{Cost to Scribe} & \tb{Item Level} \\
                \bottomrule
                1st-Level & 50 gp & 1st \\
                2nd-Level & 200 gp & 3rd \\
                3rd-Level & 500 gp & 4th \\
                4th-Level & 1,250 gp & 7th \\
                5th-Level & 3,000 gp & 9th \\
                6th-Level & 7,500 gp & 11th \\
                7th-Level & 15,000 gp & 12th \\
                8th-Level & 35,000 gp & 14th \\
                9th-Level & 75,000 gp & 16th \\
            \end{dtabularx}
        \end{dtable}

    \subsection{Subrituals}\label{Subrituals}
        Many rituals have \glossterm{subrituals}, just like many spells have \glossterm{subspells} (see \pcref{Subspells}).
        Subrituals work in the same way as subspells, except that they are applied to rituals instead of spells.

    \subsection{Performing Rituals}
        To perform a ritual, you must have a ritual book containing the ritual and the material components required for the ritual.
        Unless otherwise specified, performing a ritual requires spending a single \glossterm{action point}.
        Some rituals require multiple action points to complete.
        Other creatures can supply action points to help you perform rituals; see Ritual Participants, below.

        % The action point cost for 24 hour rituals is equal to (ritual level ^ 2) * 2.
        % Should this be specified explicitly?

        Rituals with the \glossterm{Attune} tag do not cost action points to perform, but require a ritual participant to attune to the ritual's effect, which costs an action point.
        For details, see \pcref{Attunement}.

        % TODO: can we remove all instance of ``casting a ritual''?
        Performing a ritual and casting a ritual mean the same thing.

        \subsubsection{Ritual Participants}
            Creatures can assist in the performance of rituals even if they are unable to perform rituals themselves.
            A creature that helps perform a ritual is called a ritual participant, and the creature performing the ritual is called the ritual leader.
            A ritual participant may spend an action point in place of or in addition to the action point spent by the creature performing the ritual.
            It may also \glossterm{attune} to the effect of the ritual in place of the creature performing the ritual.
            Only one creature may attune to the ritual's effect in this way.
            If multiple creatures are willing to spend action points or attune to effects, the ritual leader decides which creatures spend action points or attune to the ritual's effects.

            The steps required to participate in rituals can be complex.
            Ritual participants must be given specific instructions for the actions they must perform during a ritual by a creature who knows how to perform the ritual.
            This instruction generally takes half the time required to perform the ritual.
            A creature cannot participate in rituals unless it has an Intelligence of at least 0, can speak at least one language, and has the fine motor control required to perform the somatic components of spells.

            Normally, a ritual participant can only contribute one action point.
            If the participant can cast spells from the same source as the ritual, they can contribute any number of action points.

            \parhead{Changing Ritual Participation}
            Rituals are deeply complex magic, and they cannot be abandoned or paused partway through.
            If the number of ritual participants in a ritual decreases below its initial value, the ritual fails at the end of the next round if the number of participants is not restored.
            However, ritual participants can transfer their participation to other creatures without disrupting the ritual.

            In order to transfer ritual participation, the new creature must be able to participate in the ritual, and must immediately spend the same number of action points as the creature that it is taking over from.
            Similarly, the ritual leader can transfer their leadership to another creature.
            In addition to the requirements for transferring ritual participation, the new leader must know the ritual and be able to perform it themselves.

            Changing ritual participation and leadership is usually done when performing extraordinarily long or demanding rituals.

    \subsection{Magical Writings}
        To record a spell in written form, a character uses complex notation that describes the magical forces involved in the spell.
        The notation constitutes a universal language that spellcasters have discovered, not invented.
        Each writer uses this universal system regardless of their native language or culture.
        However, each character uses the system in their own way.
        Another person's magical writing remains incomprehensible to even the most powerful spellcaster until they take the time to study and decipher it.

        To decipher an magical writing (such as a single spell in written form on a scroll), you must make a Spellcraft check (DR 10 \add the spell's level). If the skill check fails, you cannot attempt to read that particular spell again until the next day.
        A \ritual{read magic} ritual automatically deciphers a magical writing without a skill check.
        If the person who created the magical writing is on hand to help the reader, success is also automatic.

        Once a character deciphers a particular magical writing, they do not need to decipher it again.
        Deciphering a magical writing allows the reader to identify the spell and gives some idea of its effects (as explained in the spell or ritual description).
        

\section{Spell Lists}

\input{spell_lists.tex}

\section{Spell Descriptions}

\input{spell_descriptions.tex}

\section{Ritual Descriptions}

\input{ritual_descriptions.tex}
